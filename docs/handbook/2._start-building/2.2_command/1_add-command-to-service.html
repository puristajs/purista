<!DOCTYPE html>
<html lang="en-US" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-beta.61" />
    <meta name="theme" content="VuePress Theme Hope" />
    <meta property="og:url" content="https://purista.dev/handbook/2._start-building/2.2_command/1_add-command-to-service.html"><meta property="og:site_name" content="PURISTA"><meta property="og:title" content="Add a command to a service"><meta property="og:description" content="Add a command to an existing service"><meta property="og:type" content="article"><meta property="og:image" content="/graphic/advertise_large.svg"><meta property="og:locale" content="en-US"><meta property="og:updated_time" content="2023-03-29T09:05:20.000Z"><meta name="twitter:card" content="summary_large_image"><meta name="twitter:image:alt" content="Add a command to a service"><meta property="article:author" content="Sebastian Wessel"><meta property="article:tag" content="typescript"><meta property="article:tag" content="nodejs"><meta property="article:tag" content="javascript"><meta property="article:tag" content="backend"><meta property="article:tag" content="framework"><meta property="article:tag" content="cloud"><meta property="article:tag" content="microservice"><meta property="article:tag" content="lambda"><meta property="article:tag" content="Installation"><meta property="article:tag" content="Setup"><meta property="article:tag" content="Guide"><meta property="article:modified_time" content="2023-03-29T09:05:20.000Z"><script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"Add a command to a service","image":["/graphic/advertise_large.svg"],"dateModified":"2023-03-29T09:05:20.000Z","author":[{"@type":"Person","name":"Sebastian Wessel","url":"https://sebastianwessel.de"}]}</script><title>Add a command to a service | PURISTA</title><meta name="description" content="Add a command to an existing service">
    <style>
      :root {
        --bg-color: #fff;
      }

      html[data-theme="dark"] {
        --bg-color: #1d1e1f;
      }

      html,
      body {
        background: var(--bg-color);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <link rel="preload" href="/assets/style-437ed9f6.css" as="style"><link rel="stylesheet" href="/assets/style-437ed9f6.css">
    <link rel="modulepreload" href="/assets/app-7ccf318c.js"><link rel="modulepreload" href="/assets/framework-d89ed822.js"><link rel="modulepreload" href="/assets/1_add-command-to-service.html-d97a57c6.js"><link rel="modulepreload" href="/assets/1_add-command-to-service.html-cd49c7b7.js"><link rel="prefetch" href="/assets/index.html-b9dba94b.js" as="script"><link rel="prefetch" href="/assets/imprint.html-bd958c9f.js" as="script"><link rel="prefetch" href="/assets/intro.html-9bb7854a.js" as="script"><link rel="prefetch" href="/assets/privacy.html-fb742b8d.js" as="script"><link rel="prefetch" href="/assets/index.html-024c2125.js" as="script"><link rel="prefetch" href="/assets/modules.html-b87c1f16.js" as="script"><link rel="prefetch" href="/assets/2023-14-01-purista-typescript-framework-version_1_5_0.html-6b7cb696.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.EBMessageType.html-12b0e249.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.StatusCode.html-d6be62e2.js" as="script"><link rel="prefetch" href="/assets/purista_core.EBMessageType.html-1808cc63.js" as="script"><link rel="prefetch" href="/assets/purista_core.PuristaSpanName.html-2df96dc1.js" as="script"><link rel="prefetch" href="/assets/purista_core.PuristaSpanTag.html-50a33844.js" as="script"><link rel="prefetch" href="/assets/purista_core.ServiceEventsNames.html-1227d33d.js" as="script"><link rel="prefetch" href="/assets/purista_core.StatusCode.html-093c087b.js" as="script"><link rel="prefetch" href="/assets/purista_core.StoreType.html-01ec3ba4.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.EBMessageType.html-40b737f4.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.StatusCode.html-2ca1a13a.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.EBMessageType.html-f5c010b8.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.StatusCode.html-879cf66d.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.EventBridge.html-9aebfb91.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.IEmitter.html-4d36b474.js" as="script"><link rel="prefetch" href="/assets/purista_core.ConfigStore.html-1776a2eb.js" as="script"><link rel="prefetch" href="/assets/purista_core.EventBridge.html-064a331f.js" as="script"><link rel="prefetch" href="/assets/purista_core.IEmitter.html-2c0bf320.js" as="script"><link rel="prefetch" href="/assets/purista_core.ILogger.html-808c9873.js" as="script"><link rel="prefetch" href="/assets/purista_core.SecretStore.html-e7602b56.js" as="script"><link rel="prefetch" href="/assets/purista_core.ServiceClass.html-853c185d.js" as="script"><link rel="prefetch" href="/assets/purista_core.StateStore.html-e5661f66.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.ConfigStore.html-a4cca519.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.EventBridge.html-e352b9ec.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.IEmitter.html-9231a31e.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.SecretStore.html-feb0a012.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.ServiceClass.html-99f74364.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.StateStore.html-ee455c3e.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.ConfigStore.html-539a80a8.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.EventBridge.html-bd852783.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.IEmitter.html-658c5c88.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.SecretStore.html-cf1d35ef.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.ServiceClass.html-192dbd77.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.StateStore.html-588890f7.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.internal.StateStore.html-95d5f163.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.html-add818b6.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.html-fee9f5fe.js" as="script"><link rel="prefetch" href="/assets/purista_core.internal.html-5b0968fb.js" as="script"><link rel="prefetch" href="/assets/purista_core.html-210e7a0d.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.html-3eec18c0.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.html-8a05997b.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.html-cfe4e2cc.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.html-b3c47d1e.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.internal.html-b3399ad9.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.html-58b61af3.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.AmqpBridge.html-7b08ec33.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.EventBridgeBaseClass.html-9760f89e.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.GenericEventEmitter.html-2f837a24.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.HandledError.html-50819717.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.Logger.html-8e9dc3ad.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.UnhandledError.html-30e3dfe6.js" as="script"><link rel="prefetch" href="/assets/purista_core.CommandDefinitionBuilder.html-449da062.js" as="script"><link rel="prefetch" href="/assets/purista_core.ConfigStoreBaseClass.html-c6f07ed4.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultConfigStore.html-d27275ec.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultEventBridge.html-a496e501.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultLogger.html-42b2c81c.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultSecretStore.html-0d46a093.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultStateStore.html-84f8d1e7.js" as="script"><link rel="prefetch" href="/assets/purista_core.EventBridgeBaseClass.html-0aa1848b.js" as="script"><link rel="prefetch" href="/assets/purista_core.GenericEventEmitter.html-9472acc3.js" as="script"><link rel="prefetch" href="/assets/purista_core.HandledError.html-39efc7df.js" as="script"><link rel="prefetch" href="/assets/purista_core.Logger.html-a48f411e.js" as="script"><link rel="prefetch" href="/assets/purista_core.SecretStoreBaseClass.html-d52d9818.js" as="script"><link rel="prefetch" href="/assets/purista_core.Service.html-4bdedb7e.js" as="script"><link rel="prefetch" href="/assets/purista_core.ServiceBuilder.html-d2aa735a.js" as="script"><link rel="prefetch" href="/assets/purista_core.StateStoreBaseClass.html-454cb13b.js" as="script"><link rel="prefetch" href="/assets/purista_core.SubscriptionDefinitionBuilder.html-51c384cd.js" as="script"><link rel="prefetch" href="/assets/purista_core.UnhandledError.html-30d11880.js" as="script"><link rel="prefetch" href="/assets/purista_core.internal.ServiceBaseClass.html-62453aaa.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.CommandDefinitionBuilder.html-a69aa454.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.GenericEventEmitter.html-04dc5bf8.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.HandledError.html-fd9dc399.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.HttpServerClass.html-1cd1e3e8.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.Logger.html-24d4d1bf.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.Service.html-44486669.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.ServiceBaseClass.html-21943eba.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.ServiceBuilder.html-86743481.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.SubscriptionDefinitionBuilder.html-420c0909.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.GenericEventEmitter.html-e8b67ed4.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.HandledError.html-31214d84.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.Logger.html-66131f7a.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.Service.html-0372531b.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.ServiceBaseClass.html-dead71bd.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.RedisStateStore.html-3b13b3e0.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.internal.Logger.html-ed7d567d.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.internal.StateStoreBaseClass.html-11f5d565.js" as="script"><link rel="prefetch" href="/assets/index.html-eb709bfe.js" as="script"><link rel="prefetch" href="/assets/articles.html-07611451.js" as="script"><link rel="prefetch" href="/assets/books.html-516b0b77.js" as="script"><link rel="prefetch" href="/assets/0_concept.html-73a9ef34.js" as="script"><link rel="prefetch" href="/assets/1_purista_cli.html-fa41aecd.js" as="script"><link rel="prefetch" href="/assets/2_recommended_project_structure.html-14e40551.js" as="script"><link rel="prefetch" href="/assets/3_builders.html-996416ed.js" as="script"><link rel="prefetch" href="/assets/100_insights.html-25fd6cb2.js" as="script"><link rel="prefetch" href="/assets/1_Event_bridge.html-8539d641.js" as="script"><link rel="prefetch" href="/assets/2_default-event-bridge.html-94ec41e3.js" as="script"><link rel="prefetch" href="/assets/3_amqp-event-bridge.html-f4931867.js" as="script"><link rel="prefetch" href="/assets/4_mqtt.html-0c50995b.js" as="script"><link rel="prefetch" href="/assets/5_dapr.html-e5bd4fc2.js" as="script"><link rel="prefetch" href="/assets/6_kubemq.html-65b52081.js" as="script"><link rel="prefetch" href="/assets/7_nats.html-ab37b700.js" as="script"><link rel="prefetch" href="/assets/8_aws_eventbridge.html-2ddc4648.js" as="script"><link rel="prefetch" href="/assets/99_Implement_a_bridge.html-9943d8c5.js" as="script"><link rel="prefetch" href="/assets/9_knative.html-ef6f33f3.js" as="script"><link rel="prefetch" href="/assets/0_http_server_service.html-6cf266fe.js" as="script"><link rel="prefetch" href="/assets/1_graphql.html-3fcd941c.js" as="script"><link rel="prefetch" href="/assets/0_opentelemetry.html-092ba97c.js" as="script"><link rel="prefetch" href="/assets/aws_distro.html-b432f7fd.js" as="script"><link rel="prefetch" href="/assets/azure_monitor.html-7a61a0c0.js" as="script"><link rel="prefetch" href="/assets/google_cloud_trace.html-0508fd41.js" as="script"><link rel="prefetch" href="/assets/grafana.html-4060edc3.js" as="script"><link rel="prefetch" href="/assets/jaeger.html-f03d668e.js" as="script"><link rel="prefetch" href="/assets/signoz.html-177e8552.js" as="script"><link rel="prefetch" href="/assets/uptrace.html-76d438f1.js" as="script"><link rel="prefetch" href="/assets/zipkin.html-0d21329d.js" as="script"><link rel="prefetch" href="/assets/0_scale.html-01e631d9.js" as="script"><link rel="prefetch" href="/assets/2_edge_device.html-47eae736.js" as="script"><link rel="prefetch" href="/assets/2_monolithic.html-ca00cae8.js" as="script"><link rel="prefetch" href="/assets/3_microservice_style.html-6194ddec.js" as="script"><link rel="prefetch" href="/assets/4_lambda_style.html-a35dfb1c.js" as="script"><link rel="prefetch" href="/assets/0_deployment.html-d21e7c80.js" as="script"><link rel="prefetch" href="/assets/1_edge.html-e488d5bf.js" as="script"><link rel="prefetch" href="/assets/2_kubernetes.html-289adb14.js" as="script"><link rel="prefetch" href="/assets/4_serverless.html-a6823fa7.js" as="script"><link rel="prefetch" href="/assets/1_temporal.html-2848d039.js" as="script"><link rel="prefetch" href="/assets/2_triggermesh.html-8de12a51.js" as="script"><link rel="prefetch" href="/assets/3_aws_setp_functions.html-d178e17d.js" as="script"><link rel="prefetch" href="/assets/1_create-new-service.html-e3005628.js" as="script"><link rel="prefetch" href="/assets/2_custom_service_class.html-93473dc1.js" as="script"><link rel="prefetch" href="/assets/3_service_advanced.html-248cf5eb.js" as="script"><link rel="prefetch" href="/assets/2_test-a-command.html-a7e2c498.js" as="script"><link rel="prefetch" href="/assets/3_command-hooks.html-f34775a6.js" as="script"><link rel="prefetch" href="/assets/0_error-handling.html-beafbdd1.js" as="script"><link rel="prefetch" href="/assets/1_add-subscription-to-service.html-7bc5101e.js" as="script"><link rel="prefetch" href="/assets/2_test-a-subscription.html-f5b14250.js" as="script"><link rel="prefetch" href="/assets/3_subscription-hooks.html-7cf94b50.js" as="script"><link rel="prefetch" href="/assets/1_config_store.html-b6f8b553.js" as="script"><link rel="prefetch" href="/assets/2_secret_store.html-1f548f05.js" as="script"><link rel="prefetch" href="/assets/3_state_store.html-e58c49fa.js" as="script"><link rel="prefetch" href="/assets/1_logging.html-87d0d5f6.js" as="script"><link rel="prefetch" href="/assets/2_custom_events.html-1be3c9ce.js" as="script"><link rel="prefetch" href="/assets/3_execute_commands.html-96882bbe.js" as="script"><link rel="prefetch" href="/assets/404.html-ef5f8e9a.js" as="script"><link rel="prefetch" href="/assets/index.html-e0890bff.js" as="script"><link rel="prefetch" href="/assets/index.html-4b58c874.js" as="script"><link rel="prefetch" href="/assets/index.html-b530e4b3.js" as="script"><link rel="prefetch" href="/assets/index.html-33fb7ea8.js" as="script"><link rel="prefetch" href="/assets/index.html-5bbcdcd6.js" as="script"><link rel="prefetch" href="/assets/index.html-c8819ca6.js" as="script"><link rel="prefetch" href="/assets/index.html-90a4af9e.js" as="script"><link rel="prefetch" href="/assets/index.html-a8ef4831.js" as="script"><link rel="prefetch" href="/assets/index.html-a578942b.js" as="script"><link rel="prefetch" href="/assets/index.html-25e30823.js" as="script"><link rel="prefetch" href="/assets/index.html-ded5514e.js" as="script"><link rel="prefetch" href="/assets/index.html-5c9c2a58.js" as="script"><link rel="prefetch" href="/assets/index.html-fd43c72f.js" as="script"><link rel="prefetch" href="/assets/index.html-d4647a28.js" as="script"><link rel="prefetch" href="/assets/index.html-f5429c76.js" as="script"><link rel="prefetch" href="/assets/index.html-f7945ceb.js" as="script"><link rel="prefetch" href="/assets/index.html-d85feca9.js" as="script"><link rel="prefetch" href="/assets/index.html-228000a6.js" as="script"><link rel="prefetch" href="/assets/index.html-df862512.js" as="script"><link rel="prefetch" href="/assets/index.html-7275ac88.js" as="script"><link rel="prefetch" href="/assets/index.html-b32446f0.js" as="script"><link rel="prefetch" href="/assets/index.html-47e3cfa5.js" as="script"><link rel="prefetch" href="/assets/index.html-1a19d44f.js" as="script"><link rel="prefetch" href="/assets/index.html-b7f796f1.js" as="script"><link rel="prefetch" href="/assets/index.html-537a4d62.js" as="script"><link rel="prefetch" href="/assets/index.html-34d90c76.js" as="script"><link rel="prefetch" href="/assets/index.html-9ca6a519.js" as="script"><link rel="prefetch" href="/assets/index.html-f437e8d8.js" as="script"><link rel="prefetch" href="/assets/index.html-c093e4fc.js" as="script"><link rel="prefetch" href="/assets/index.html-813abdd9.js" as="script"><link rel="prefetch" href="/assets/index.html-7146cafb.js" as="script"><link rel="prefetch" href="/assets/imprint.html-43eb05e8.js" as="script"><link rel="prefetch" href="/assets/intro.html-41e845fc.js" as="script"><link rel="prefetch" href="/assets/privacy.html-a8ede0a2.js" as="script"><link rel="prefetch" href="/assets/index.html-97a6d327.js" as="script"><link rel="prefetch" href="/assets/modules.html-3f51ee4d.js" as="script"><link rel="prefetch" href="/assets/2023-14-01-purista-typescript-framework-version_1_5_0.html-84de1eda.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.EBMessageType.html-8a270e94.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.StatusCode.html-3d3afd24.js" as="script"><link rel="prefetch" href="/assets/purista_core.EBMessageType.html-4c92af23.js" as="script"><link rel="prefetch" href="/assets/purista_core.PuristaSpanName.html-32e24a99.js" as="script"><link rel="prefetch" href="/assets/purista_core.PuristaSpanTag.html-a1af06ce.js" as="script"><link rel="prefetch" href="/assets/purista_core.ServiceEventsNames.html-7cbfeb20.js" as="script"><link rel="prefetch" href="/assets/purista_core.StatusCode.html-392d710e.js" as="script"><link rel="prefetch" href="/assets/purista_core.StoreType.html-e4b12631.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.EBMessageType.html-1b275460.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.StatusCode.html-82ab6050.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.EBMessageType.html-482abd1c.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.StatusCode.html-e4bf4701.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.EventBridge.html-d0261088.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.IEmitter.html-a52ee774.js" as="script"><link rel="prefetch" href="/assets/purista_core.ConfigStore.html-98e9d90d.js" as="script"><link rel="prefetch" href="/assets/purista_core.EventBridge.html-e453bf04.js" as="script"><link rel="prefetch" href="/assets/purista_core.IEmitter.html-261b4217.js" as="script"><link rel="prefetch" href="/assets/purista_core.ILogger.html-6efdf2d9.js" as="script"><link rel="prefetch" href="/assets/purista_core.SecretStore.html-aaccf21c.js" as="script"><link rel="prefetch" href="/assets/purista_core.ServiceClass.html-49cdce7d.js" as="script"><link rel="prefetch" href="/assets/purista_core.StateStore.html-11b2d0b7.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.ConfigStore.html-b3cfe4af.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.EventBridge.html-29fc4d5b.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.IEmitter.html-e4951d92.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.SecretStore.html-191858b2.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.ServiceClass.html-f1264f8e.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.StateStore.html-7ea58514.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.ConfigStore.html-55994f97.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.EventBridge.html-1c1e08d2.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.IEmitter.html-dfe08df4.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.SecretStore.html-4c0473b4.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.ServiceClass.html-4a0ebf41.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.StateStore.html-e5cd3b03.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.internal.StateStore.html-04633f6c.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.html-da4c63d9.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.html-3e59dd5e.js" as="script"><link rel="prefetch" href="/assets/purista_core.internal.html-c84eeb7b.js" as="script"><link rel="prefetch" href="/assets/purista_core.html-1d8c3216.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.html-1d83a589.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.html-9ed8bcff.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.html-ca8a2aa5.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.html-46acd9b2.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.internal.html-e33cce56.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.html-77a8f9e2.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.AmqpBridge.html-630bf821.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.EventBridgeBaseClass.html-d2316707.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.GenericEventEmitter.html-c2d34b05.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.HandledError.html-ccd142bd.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.Logger.html-73dc02f0.js" as="script"><link rel="prefetch" href="/assets/purista_amqpbridge.internal.UnhandledError.html-99c86ce9.js" as="script"><link rel="prefetch" href="/assets/purista_core.CommandDefinitionBuilder.html-78c7e084.js" as="script"><link rel="prefetch" href="/assets/purista_core.ConfigStoreBaseClass.html-d00237ba.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultConfigStore.html-c081405d.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultEventBridge.html-db8e12c8.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultLogger.html-d12e1497.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultSecretStore.html-558e3a74.js" as="script"><link rel="prefetch" href="/assets/purista_core.DefaultStateStore.html-f0a17840.js" as="script"><link rel="prefetch" href="/assets/purista_core.EventBridgeBaseClass.html-4b7d8761.js" as="script"><link rel="prefetch" href="/assets/purista_core.GenericEventEmitter.html-e3d4ce10.js" as="script"><link rel="prefetch" href="/assets/purista_core.HandledError.html-1af99766.js" as="script"><link rel="prefetch" href="/assets/purista_core.Logger.html-778e3d9e.js" as="script"><link rel="prefetch" href="/assets/purista_core.SecretStoreBaseClass.html-66e208cf.js" as="script"><link rel="prefetch" href="/assets/purista_core.Service.html-47f0d938.js" as="script"><link rel="prefetch" href="/assets/purista_core.ServiceBuilder.html-aa08915e.js" as="script"><link rel="prefetch" href="/assets/purista_core.StateStoreBaseClass.html-de2db84c.js" as="script"><link rel="prefetch" href="/assets/purista_core.SubscriptionDefinitionBuilder.html-ffb8f660.js" as="script"><link rel="prefetch" href="/assets/purista_core.UnhandledError.html-dc559f22.js" as="script"><link rel="prefetch" href="/assets/purista_core.internal.ServiceBaseClass.html-0adb7f6c.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.CommandDefinitionBuilder.html-dfb531f2.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.GenericEventEmitter.html-32b8e26b.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.HandledError.html-1285b739.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.HttpServerClass.html-9eed80be.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.Logger.html-a2cb5ab5.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.Service.html-65b22131.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.ServiceBaseClass.html-6902cbc4.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.ServiceBuilder.html-36af72a4.js" as="script"><link rel="prefetch" href="/assets/purista_httpserver.internal.SubscriptionDefinitionBuilder.html-28031517.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.GenericEventEmitter.html-da5020c8.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.HandledError.html-1c675278.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.Logger.html-21f58b69.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.Service.html-03cc7c7d.js" as="script"><link rel="prefetch" href="/assets/purista_k8s_sdk.internal.ServiceBaseClass.html-2d5942f5.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.RedisStateStore.html-aae5bd96.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.internal.Logger.html-fa35cb2a.js" as="script"><link rel="prefetch" href="/assets/purista_redis_state_store.internal.StateStoreBaseClass.html-3aaf3ed4.js" as="script"><link rel="prefetch" href="/assets/index.html-2ac880e4.js" as="script"><link rel="prefetch" href="/assets/articles.html-98ff99a4.js" as="script"><link rel="prefetch" href="/assets/books.html-1d5fd4a0.js" as="script"><link rel="prefetch" href="/assets/0_concept.html-3046b37e.js" as="script"><link rel="prefetch" href="/assets/1_purista_cli.html-67c96b4c.js" as="script"><link rel="prefetch" href="/assets/2_recommended_project_structure.html-06edd9d9.js" as="script"><link rel="prefetch" href="/assets/3_builders.html-f61dc589.js" as="script"><link rel="prefetch" href="/assets/100_insights.html-ccc2c729.js" as="script"><link rel="prefetch" href="/assets/1_Event_bridge.html-e5d1ac31.js" as="script"><link rel="prefetch" href="/assets/2_default-event-bridge.html-12aea2d9.js" as="script"><link rel="prefetch" href="/assets/3_amqp-event-bridge.html-c243ee5e.js" as="script"><link rel="prefetch" href="/assets/4_mqtt.html-75cc25cd.js" as="script"><link rel="prefetch" href="/assets/5_dapr.html-fe68b6ed.js" as="script"><link rel="prefetch" href="/assets/6_kubemq.html-e70c4b85.js" as="script"><link rel="prefetch" href="/assets/7_nats.html-3e109791.js" as="script"><link rel="prefetch" href="/assets/8_aws_eventbridge.html-b9f307e9.js" as="script"><link rel="prefetch" href="/assets/99_Implement_a_bridge.html-a81f0926.js" as="script"><link rel="prefetch" href="/assets/9_knative.html-981b093d.js" as="script"><link rel="prefetch" href="/assets/0_http_server_service.html-809dc1aa.js" as="script"><link rel="prefetch" href="/assets/1_graphql.html-28d23bc6.js" as="script"><link rel="prefetch" href="/assets/0_opentelemetry.html-3a2ed672.js" as="script"><link rel="prefetch" href="/assets/aws_distro.html-7f9d7e9d.js" as="script"><link rel="prefetch" href="/assets/azure_monitor.html-a2b58fe4.js" as="script"><link rel="prefetch" href="/assets/google_cloud_trace.html-1645cc0b.js" as="script"><link rel="prefetch" href="/assets/grafana.html-5e4e7aca.js" as="script"><link rel="prefetch" href="/assets/jaeger.html-24e94111.js" as="script"><link rel="prefetch" href="/assets/signoz.html-852e8509.js" as="script"><link rel="prefetch" href="/assets/uptrace.html-e80a9cb0.js" as="script"><link rel="prefetch" href="/assets/zipkin.html-aa1abf1c.js" as="script"><link rel="prefetch" href="/assets/0_scale.html-714fcc24.js" as="script"><link rel="prefetch" href="/assets/2_edge_device.html-09214eb7.js" as="script"><link rel="prefetch" href="/assets/2_monolithic.html-f38a5182.js" as="script"><link rel="prefetch" href="/assets/3_microservice_style.html-61a92441.js" as="script"><link rel="prefetch" href="/assets/4_lambda_style.html-e85d59ee.js" as="script"><link rel="prefetch" href="/assets/0_deployment.html-3ab39d52.js" as="script"><link rel="prefetch" href="/assets/1_edge.html-48880bcd.js" as="script"><link rel="prefetch" href="/assets/2_kubernetes.html-1cd62144.js" as="script"><link rel="prefetch" href="/assets/4_serverless.html-bb7dd0ee.js" as="script"><link rel="prefetch" href="/assets/1_temporal.html-92648a18.js" as="script"><link rel="prefetch" href="/assets/2_triggermesh.html-4b2ada85.js" as="script"><link rel="prefetch" href="/assets/3_aws_setp_functions.html-83605f44.js" as="script"><link rel="prefetch" href="/assets/1_create-new-service.html-629daf77.js" as="script"><link rel="prefetch" href="/assets/2_custom_service_class.html-e1401a71.js" as="script"><link rel="prefetch" href="/assets/3_service_advanced.html-07d90c38.js" as="script"><link rel="prefetch" href="/assets/2_test-a-command.html-58c1d1dd.js" as="script"><link rel="prefetch" href="/assets/3_command-hooks.html-0ce29144.js" as="script"><link rel="prefetch" href="/assets/0_error-handling.html-e1243fbf.js" as="script"><link rel="prefetch" href="/assets/1_add-subscription-to-service.html-6eda922b.js" as="script"><link rel="prefetch" href="/assets/2_test-a-subscription.html-f376c1aa.js" as="script"><link rel="prefetch" href="/assets/3_subscription-hooks.html-3fd1aafb.js" as="script"><link rel="prefetch" href="/assets/1_config_store.html-67d1ba08.js" as="script"><link rel="prefetch" href="/assets/2_secret_store.html-55e63821.js" as="script"><link rel="prefetch" href="/assets/3_state_store.html-18f729ed.js" as="script"><link rel="prefetch" href="/assets/1_logging.html-b9f5c361.js" as="script"><link rel="prefetch" href="/assets/2_custom_events.html-b56e354a.js" as="script"><link rel="prefetch" href="/assets/3_execute_commands.html-77ea8b7a.js" as="script"><link rel="prefetch" href="/assets/404.html-3e3358e6.js" as="script"><link rel="prefetch" href="/assets/index.html-21281d29.js" as="script"><link rel="prefetch" href="/assets/index.html-be4e738e.js" as="script"><link rel="prefetch" href="/assets/index.html-e20ff4da.js" as="script"><link rel="prefetch" href="/assets/index.html-1830d6a3.js" as="script"><link rel="prefetch" href="/assets/index.html-d7eb6791.js" as="script"><link rel="prefetch" href="/assets/index.html-e65e32fb.js" as="script"><link rel="prefetch" href="/assets/index.html-7d2a7bf4.js" as="script"><link rel="prefetch" href="/assets/index.html-1f658f5a.js" as="script"><link rel="prefetch" href="/assets/index.html-a1bcbed7.js" as="script"><link rel="prefetch" href="/assets/index.html-e061141b.js" as="script"><link rel="prefetch" href="/assets/index.html-84aa3a6d.js" as="script"><link rel="prefetch" href="/assets/index.html-07946506.js" as="script"><link rel="prefetch" href="/assets/index.html-1cb60874.js" as="script"><link rel="prefetch" href="/assets/index.html-6c346ba5.js" as="script"><link rel="prefetch" href="/assets/index.html-8550eb76.js" as="script"><link rel="prefetch" href="/assets/index.html-5873459d.js" as="script"><link rel="prefetch" href="/assets/index.html-f79b523c.js" as="script"><link rel="prefetch" href="/assets/index.html-d6074a10.js" as="script"><link rel="prefetch" href="/assets/index.html-c6200b10.js" as="script"><link rel="prefetch" href="/assets/index.html-6a10ac2b.js" as="script"><link rel="prefetch" href="/assets/index.html-983bcde5.js" as="script"><link rel="prefetch" href="/assets/index.html-9c999221.js" as="script"><link rel="prefetch" href="/assets/index.html-5261656a.js" as="script"><link rel="prefetch" href="/assets/index.html-034c9af9.js" as="script"><link rel="prefetch" href="/assets/index.html-b1862a6b.js" as="script"><link rel="prefetch" href="/assets/index.html-1c8a0ad1.js" as="script"><link rel="prefetch" href="/assets/index.html-cffc0010.js" as="script"><link rel="prefetch" href="/assets/index.html-5b984412.js" as="script"><link rel="prefetch" href="/assets/index.html-b91e858e.js" as="script"><link rel="prefetch" href="/assets/index.html-215683a8.js" as="script"><link rel="prefetch" href="/assets/flowchart-35969cab.js" as="script"><link rel="prefetch" href="/assets/mermaid.core-312d98ef.js" as="script"><link rel="prefetch" href="/assets/highlight.esm-a794bb63.js" as="script"><link rel="prefetch" href="/assets/markdown.esm-d92a2fc9.js" as="script"><link rel="prefetch" href="/assets/math.esm-70a288c8.js" as="script"><link rel="prefetch" href="/assets/notes.esm-224f94d9.js" as="script"><link rel="prefetch" href="/assets/reveal.esm-e5069ce0.js" as="script"><link rel="prefetch" href="/assets/search.esm-2c3fba7d.js" as="script"><link rel="prefetch" href="/assets/zoom.esm-b83b91d0.js" as="script"><link rel="prefetch" href="/assets/photoswipe.esm-36cd6c3c.js" as="script">
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="skip-link sr-only">Skip to main content</a><!--]--><!--[--><div class="theme-container has-toc"><!--[--><header class="navbar" id="navbar"><div class="navbar-start"><button type="button" class="toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><!----><!--]--><a href="/" class="brand"><!----><!----><span class="site-name">PURISTA</span></a><!--[--><!----><!--]--></div><div class="navbar-center"><!--[--><!----><!--]--><nav class="nav-links"><div class="nav-item hide-in-mobile"><a href="/handbook/1._get-started/0_concept.html" class="nav-link" aria-label="Handbook"><!---->Handbook<!----></a></div><div class="nav-item hide-in-mobile"><a href="/article" class="nav-link" aria-label="Blog"><!---->Blog<!----></a></div><div class="nav-item hide-in-mobile"><a href="/api" class="nav-link" aria-label="API"><!---->API<!----></a></div><div class="nav-item hide-in-mobile"><a href="/resources" class="nav-link" aria-label="Resources"><!---->Resources<!----></a></div></nav><!--[--><!----><!--]--></div><div class="navbar-end"><!--[--><!----><!--]--><!----><div class="nav-item"><a class="repo-link" href="https://github.com/sebastianwessel/purista" target="_blank" rel="noopener noreferrer" aria-label="PURISTA"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="nav-item hide-in-mobile"><div class="full-screen-wrapper"><label class="full-screen-title" for="full-screen-switch">Full Screen</label><button type="button" class="full-screen" id="full-screen-switch" ariapressed="false"><svg xmlns="http://www.w3.org/2000/svg" class="icon enter-fullscreen-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="enter-fullscreen icon"><path d="M762.773 90.24h-497.28c-96.106 0-174.4 78.293-174.4 174.4v497.28c0 96.107 78.294 174.4 174.4 174.4h497.28c96.107 0 175.04-78.293 174.4-174.4V264.64c0-96.213-78.186-174.4-174.4-174.4zm-387.2 761.173H215.04c-21.867 0-40.427-17.92-41.067-41.066V649.92c0-22.507 17.92-40.427 40.427-40.427 11.307 0 21.227 4.694 28.48 11.947 7.253 7.253 11.947 17.92 11.947 28.48v62.293l145.28-145.28c15.893-15.893 41.813-15.893 57.706 0 15.894 15.894 15.894 41.814 0 57.707l-145.28 145.28h62.294c22.506 0 40.426 17.92 40.426 40.427s-17.173 41.066-39.68 41.066zM650.24 165.76h160.427c21.866 0 40.426 17.92 41.066 41.067v160.426c0 22.507-17.92 40.427-40.426 40.427-11.307 0-21.227-4.693-28.48-11.947-7.254-7.253-11.947-17.92-11.947-28.48v-62.186L625.6 450.347c-15.893 15.893-41.813 15.893-57.707 0-15.893-15.894-15.893-41.814 0-57.707l145.28-145.28H650.88c-22.507 0-40.427-17.92-40.427-40.427s17.174-41.173 39.787-41.173z"></path></svg></button></div></div><!----><!--[--><!----><!--]--><button type="button" class="toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span class="button-container"><span class="button-top"></span><span class="button-middle"></span><span class="button-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside class="sidebar" id="sidebar"><!--[--><!----><!--]--><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">1. Get Started</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><!----><span class="title">2. Start Building</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">2.1 Service</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable active" type="button"><!----><span class="title">2.2 Command</span><span class="arrow down"></span></button><ul class="sidebar-links"><li><!--[--><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html" class="router-link-active router-link-exact-active nav-link active sidebar-link sidebar-page active" aria-label="Add a command"><!---->Add a command<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#create-the-files" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Create the files"><!---->Create the files<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#structure" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Structure"><!---->Structure<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#command-builder-file" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Command builder file"><!---->Command builder file<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#schema-file" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Schema file"><!---->Schema file<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#type-file" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Type file"><!---->Type file<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#test-file" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Test file"><!---->Test file<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#implement-the-command" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Implement the command"><!---->Implement the command<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#command-function-context" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Command function context"><!---->Command function context<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#payload" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Payload"><!---->Payload<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#parameter" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Parameter"><!---->Parameter<!----></a><ul class="sidebar-sub-headers"></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#return-value" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Return value"><!---->Return value<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#event-bridge-advice" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="Event bridge advice"><!---->Event bridge advice<!----></a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#adviceautoacknowledgemessage" class="router-link-active router-link-exact-active nav-link sidebar-link heading" aria-label="adviceAutoacknowledgeMessage"><!---->adviceAutoacknowledgeMessage<!----></a><ul class="sidebar-sub-headers"></ul></li></ul></li></ul><!--]--></li><li><!--[--><a href="/handbook/2._start-building/2.2_command/2_test-a-command.html" class="nav-link sidebar-link sidebar-page" aria-label="Test a command"><!---->Test a command<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li><li><!--[--><a href="/handbook/2._start-building/2.2_command/3_command-hooks.html" class="nav-link sidebar-link sidebar-page" aria-label="Transformer &amp; Guards"><!---->Transformer &amp; Guards<!----></a><ul class="sidebar-sub-headers"></ul><!--]--></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">2.3 Subscription</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">2.4. Error Handling</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">2.5 Stores</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">2.6. Advanced</span><span class="arrow end"></span></button><!----></section></li></ul></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">3. Event Bridge</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">4. Exposing</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">5. Tracing</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">6. Scale</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">7. Deployment</span><span class="arrow end"></span></button><!----></section></li><li><section class="sidebar-group"><button class="sidebar-heading clickable" type="button"><!----><span class="title">8. in Love with</span><span class="arrow end"></span></button><!----></section></li></ul><!--[--><!----><!--]--></aside><!--[--><main class="page" id="main-content"><!--[--><!----><nav class="breadcrumb disable"></nav><div class="page-title"><h1><!---->Add a command to a service</h1><div class="page-info"><span class="page-author-info" aria-label="AuthorðŸ–Š" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://sebastianwessel.de" target="_blank" rel="noopener noreferrer">Sebastian Wessel</a></span><span property="author" content="Sebastian Wessel"></span></span><span class="page-date-info" aria-label="Writing DateðŸ“…" data-balloon-pos="down"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span><!----></span><meta property="datePublished" content="2023-03-29T09:05:20.000Z"></span></div><hr></div><div class="toc-place-holder"><aside id="toc"><!--[--><!----><!--]--><div class="toc-header">On This Page<button type="button" class="print-button" title="Print"><svg xmlns="http://www.w3.org/2000/svg" class="icon print-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="print icon"><path d="M819.2 364.8h-44.8V128c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v236.8h-44.8C145.067 364.8 96 413.867 96 473.6v192c0 59.733 49.067 108.8 108.8 108.8h44.8V896c0 17.067 14.933 32 32 32h460.8c17.067 0 32-14.933 32-32V774.4h44.8c59.733 0 108.8-49.067 108.8-108.8v-192c0-59.733-49.067-108.8-108.8-108.8zM313.6 160h396.8v204.8H313.6V160zm396.8 704H313.6V620.8h396.8V864zM864 665.6c0 25.6-19.2 44.8-44.8 44.8h-44.8V588.8c0-17.067-14.933-32-32-32H281.6c-17.067 0-32 14.933-32 32v121.6h-44.8c-25.6 0-44.8-19.2-44.8-44.8v-192c0-25.6 19.2-44.8 44.8-44.8h614.4c25.6 0 44.8 19.2 44.8 44.8v192z"></path></svg></button></div><div class="toc-wrapper"><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#create-the-files" class="router-link-active router-link-exact-active toc-link level2">Create the files</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#structure" class="router-link-active router-link-exact-active toc-link level2">Structure</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#command-builder-file" class="router-link-active router-link-exact-active toc-link level3">Command builder file</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#schema-file" class="router-link-active router-link-exact-active toc-link level3">Schema file</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#type-file" class="router-link-active router-link-exact-active toc-link level3">Type file</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#test-file" class="router-link-active router-link-exact-active toc-link level3">Test file</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#implement-the-command" class="router-link-active router-link-exact-active toc-link level2">Implement the command</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#command-function-context" class="router-link-active router-link-exact-active toc-link level3">Command function context</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#payload" class="router-link-active router-link-exact-active toc-link level3">Payload</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#parameter" class="router-link-active router-link-exact-active toc-link level3">Parameter</a></li><!----><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#return-value" class="router-link-active router-link-exact-active toc-link level3">Return value</a></li><!----><!--]--></ul></li><!--]--><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#event-bridge-advice" class="router-link-active router-link-exact-active toc-link level2">Event bridge advice</a></li><li><ul class="toc-list"><!--[--><li class="toc-item"><a aria-current="page" href="/handbook/2._start-building/2.2_command/1_add-command-to-service.html#adviceautoacknowledgemessage" class="router-link-active router-link-exact-active toc-link level3">adviceAutoacknowledgeMessage</a></li><!----><!--]--></ul></li><!--]--></ul></div><!--[--><!----><!--]--></aside></div><!----><div class="theme-hope-content"><p>A command is a single function, which will be called (invoked) by someone with the expectation to get a result back.</p><h2 id="create-the-files" tabindex="-1"><a class="header-anchor" href="#create-the-files" aria-hidden="true">#</a> Create the files</h2><p>Commands can be added to services. The most sight-forward way for adding a command is the usage of the PURISTA CLI.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>purista <span class="token function">add</span> <span class="token builtin class-name">command</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The CLI will guide you through all steps and will create all files for you.<br> In the first step, you will be asked for the name of the new command.<br> We will start with <em>signUp</em>.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>? What is the name of the new <span class="token builtin class-name">command</span> sign up
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>As you can see, it is possible to enter the name of the command in a very natural way.<br> The CLI tool will handle the naming conventions for you.<br> Command names will be camel-case.</p><div class="hint-container tip"><p class="hint-container-title">Try to use a command name, which is:</p><ul><li>global unique (a command in different service versions should have the same name)</li><li>short, but speaking &amp; understandable</li><li>use simple present, like <code>addNewFeature</code> or <code>getUser</code></li><li>try to standard prefixes, like <code>createBankAccount</code> or <code>updateUserProfile</code></li></ul></div><p>After you have confirmed your input by pressing the enter key, you will be asked for a short description of the command.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>? What is the matter of <span class="token builtin class-name">command</span> <span class="token string">&quot;sign up&quot;</span> registers a new user at our product
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Here, you should enter some short, general description, which will be used for some human-facing documentation.<br> So, please provide here something like: <em>registers a new user at our product</em>.</p><p>The following step is a bit more interesting, as you will be asked for the response event name.<br> A response to a command can be marked as an event, which can be subscribed to.<br> You can leave the field blank and simply press enter if you do not want to add an event name.</p><p>For example, we want to add an event name.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>? Name of response event newUserRegistered
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>The CLI will not handle any naming conventions here. So you are free to choose.<br> The event will be automatically added as a new enum entry in <code>src/service/ServiceEvent.enum.ts</code>. This new enum entry will be used in the generated source code files.</p><div class="hint-container tip"><p class="hint-container-title">Try use an event name, which is:</p><ul><li>global unique (a command in different service versions should have the same event name)</li><li>short, but speaking &amp; understandable</li><li>should not contain a version in the name</li><li>try to describe what happened, when the command execution was successfully</li><li>use simple past, like <code>newFeatureAdded</code> or <code>userDeleted</code></li></ul></div><p>In the next step, you will see a service selection.<br> Use the arrow keys to select the service (and version), on which the new command should be registered.<br> In our example, choose <em>User</em> .</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>? <span class="token keyword">select</span> a <span class="token function">service</span> user <span class="token number">1</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>Confirm your choice by pressing the enter key.</p><p>Now, the files will be created, the event name will be added as a new enum entry and the command will be added to the command list of the service.</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>âœ”  -<span class="token operator">&gt;</span> checking current setup
âœ”  ++ /src/service/user/v1/command/signUp/index.ts
âœ”  ++ /src/service/user/v1/command/signUp/schema.ts
âœ”  ++ /src/service/user/v1/command/signUp/types.ts
âœ”  ++ /src/service/user/v1/command/signUp/signUp.test.ts
âœ”  ++ /src/service/user/v1/command/signUp/signUpCommandBuilder.ts
âœ”  _+ /src/service/user/v1/index.ts
â ‹ try to update existing files - pls be patient<span class="token operator">!</span>
ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> ensure new enum entry
â ™ ðŸ‘  -<span class="token operator">&gt;</span> event <span class="token string">&quot;newUserRegistered&quot;</span> added to enum as ServiceEvent.NewUserRegistered
ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> <span class="token builtin class-name">set</span> event name from enum <span class="token keyword">in</span> <span class="token builtin class-name">command</span> builder
ðŸ‘  -<span class="token operator">&gt;</span> updated event to use enum <span class="token keyword">in</span> <span class="token builtin class-name">command</span> builder
â ¹ ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> try to <span class="token function">add</span> definition to builder
ðŸ‘  -<span class="token operator">&gt;</span> definition added to <span class="token function">service</span> builder
â ¸ ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> lint  src/service/user/v1/command/signUp/index.ts
ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> lint  src/service/user/v1/command/signUp/schema.ts
ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> lint  src/service/user/v1/command/signUp/types.ts
ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> lint  src/service/user/v1/command/signUp/signUp.test.ts
ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> lint  src/service/user/v1/command/signUp/signUpCommandBuilder.ts
ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> lint  src/service/user/v1/userV1Service.ts
ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> lint  src/service/user/v1/index.ts
ðŸ‘·ðŸ—ï¸ -<span class="token operator">&gt;</span> lint  src/service/ServiceEvent.enum.ts
â ¼ ðŸ‘  -<span class="token operator">&gt;</span> <span class="token keyword">done</span> linting
âœ”  -<span class="token operator">&gt;</span> files updated
â ‹ 

ðŸŽ‰ The <span class="token builtin class-name">command</span> <span class="token string">&quot;sign up&quot;</span> <span class="token keyword">in</span> <span class="token function">service</span> <span class="token string">&quot;user&quot;</span> version1 is created ðŸŽ‰


start adding your business logic here:
./src/service/user/v1/command/signUp/signUpCommandBuilder.ts

âœ”  -<span class="token operator">&gt;</span> ðŸ“– Learn <span class="token function">more</span> about PURISTA at https://purista.dev
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As you can see, in the output above, the CLI will print a direct link to the command builder file, where you can start adding your business logic.</p><h2 id="structure" tabindex="-1"><a class="header-anchor" href="#structure" aria-hidden="true">#</a> Structure</h2><p>A folder for the new command is created - in our example it is <code>src/service/user/v1/command/signUp</code>.<br> Here, you can find, all files relating to this single command function.</p><h3 id="command-builder-file" tabindex="-1"><a class="header-anchor" href="#command-builder-file" aria-hidden="true">#</a> Command builder file</h3><p>The main file for a command is the command builder file - <code>signUpCommandBuilder.ts</code> in our example.<br> As you can see, the CLI tool already added some configuration properties - the ones you normally always have for a command.</p><p>The implementation of the business logic should be done in this file.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> ServiceEvent <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../../../../ServiceEvent.enum&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> userV1ServiceBuilder <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../../userV1ServiceBuilder&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span>
  userV1SignUpInputParameterSchema<span class="token punctuation">,</span>
  userV1SignUpInputPayloadSchema<span class="token punctuation">,</span>
  userV1SignUpOutputPayloadSchema<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./schema&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> signUpCommandBuilder <span class="token operator">=</span> userV1ServiceBuilder
  <span class="token comment">// command name and description</span>
  <span class="token punctuation">.</span><span class="token function">getCommandBuilder</span><span class="token punctuation">(</span><span class="token string">&#39;signUp&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;registers a new user at our product&#39;</span><span class="token punctuation">)</span>
  <span class="token comment">// adding of the response event name</span>
  <span class="token punctuation">.</span><span class="token function">setSuccessEventName</span><span class="token punctuation">(</span>ServiceEvent<span class="token punctuation">.</span>NewUserRegistered<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">addPayloadSchema</span><span class="token punctuation">(</span>userV1SignUpInputPayloadSchema<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">addParameterSchema</span><span class="token punctuation">(</span>userV1SignUpInputParameterSchema<span class="token punctuation">)</span>
  <span class="token punctuation">.</span><span class="token function">addOutputSchema</span><span class="token punctuation">(</span>userV1SignUpOutputPayloadSchema<span class="token punctuation">)</span>
  <span class="token comment">// adding the implementation of the command</span>
  <span class="token punctuation">.</span><span class="token function">setCommandFunction</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>_context<span class="token punctuation">,</span> _payload<span class="token punctuation">,</span> _parameter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// add your business logic here</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><div class="hint-container info"><p class="hint-container-title">More on command builder usage:</p><ul><li>API documentation: <a href="/api/classes/purista_core.CommandDefinitionBuilder.html#methods" class="">CommandDefinitionBuilder - Methods</a></li><li>chapter: <em>4. Exposing</em></li></ul></div><h3 id="schema-file" tabindex="-1"><a class="header-anchor" href="#schema-file" aria-hidden="true">#</a> Schema file</h3><p>The schema file contains the schemas for input and output validation.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> extendApi <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@anatine/zod-openapi&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> z <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;zod&#39;</span>

<span class="token comment">// define the input parameters</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> userV1SignUpInputParameterSchema <span class="token operator">=</span> <span class="token function">extendApi</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">object</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&#39;sign up input parameter schema&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// define the input payload</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> userV1SignUpInputPayloadSchema <span class="token operator">=</span> <span class="token function">extendApi</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&#39;sign up input payload schema&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>

<span class="token comment">// define the output payload</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> userV1SignUpOutputPayloadSchema <span class="token operator">=</span> <span class="token function">extendApi</span><span class="token punctuation">(</span>z<span class="token punctuation">.</span><span class="token function">any</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> title<span class="token operator">:</span> <span class="token string">&#39;sign up output payload schema&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>As you can see, the package <a href="https://github.com/anatine/zod-plugins/blob/main/packages/zod-openapi/README.md" target="_blank" rel="noopener noreferrer"><code>@anatine/zod-openapi</code><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> is used.<br> This gives the opportunity, to enrich the schema with more information and details, which than can be used, to improve a generated OpenAPI/AsyncAPI documentation.<br> Because of this, you can add human understandable titles, descriptions, examples and so on.<br> It is not required, but recommended, to use this package. You can also use plain <a href="https://zod.dev" target="_blank" rel="noopener noreferrer">zod<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>.</p><h3 id="type-file" tabindex="-1"><a class="header-anchor" href="#type-file" aria-hidden="true">#</a> Type file</h3><p>There is also a file <code>types.ts</code>, which contains types, that are generated out of the input and output schemas defined in <code>schema.ts</code>.<br> The types are not used by PURISTA or one of the builders. The types can be used by the developers.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> z <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;zod&#39;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span>
  userV1SignUpInputParameterSchema<span class="token punctuation">,</span>
  userV1SignUpInputPayloadSchema<span class="token punctuation">,</span>
  userV1SignUpOutputPayloadSchema<span class="token punctuation">,</span>
<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./schema&#39;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UserV1SignUpInputParameter</span> <span class="token operator">=</span> z<span class="token punctuation">.</span>input<span class="token operator">&lt;</span><span class="token keyword">typeof</span> userV1SignUpInputParameterSchema<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UserV1SignUpInputPayload</span> <span class="token operator">=</span> z<span class="token punctuation">.</span>input<span class="token operator">&lt;</span><span class="token keyword">typeof</span> userV1SignUpInputPayloadSchema<span class="token operator">&gt;</span>

<span class="token keyword">export</span> <span class="token keyword">type</span> <span class="token class-name">UserV1SignUpOutputPayload</span> <span class="token operator">=</span> z<span class="token punctuation">.</span>output<span class="token operator">&lt;</span><span class="token keyword">typeof</span> userV1SignUpOutputPayloadSchema<span class="token operator">&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="test-file" tabindex="-1"><a class="header-anchor" href="#test-file" aria-hidden="true">#</a> Test file</h3><p>The file with the <code>.test.ts</code> extension, is the unit test for the command implementation.<br> It contains a real test, which then can be extended and aligned to your actual implementation.</p><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> getCommandContextMock<span class="token punctuation">,</span> getEventBridgeMock<span class="token punctuation">,</span> getLoggerMock <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@purista/core&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> createSandbox <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;sinon&#39;</span>

<span class="token keyword">import</span> <span class="token punctuation">{</span> userV1Service <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;../../userV1Service&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> signUpCommandBuilder <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./signUpCommandBuilder&#39;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> UserV1SignUpInputParameter<span class="token punctuation">,</span> UserV1SignUpInputPayload <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;./types&#39;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">&#39;service User version 1 - command signUp&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> sandbox <span class="token operator">=</span> <span class="token function">createSandbox</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    sandbox <span class="token operator">=</span> <span class="token function">createSandbox</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    sandbox<span class="token punctuation">.</span><span class="token function">restore</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token function">test</span><span class="token punctuation">(</span><span class="token string">&#39;does not throw&#39;</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> service <span class="token operator">=</span> userV1Service<span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token function">getEventBridgeMock</span><span class="token punctuation">(</span>sandbox<span class="token punctuation">)</span><span class="token punctuation">.</span>mock<span class="token punctuation">,</span> <span class="token punctuation">{</span> logger<span class="token operator">:</span> <span class="token function">getLoggerMock</span><span class="token punctuation">(</span>sandbox<span class="token punctuation">)</span><span class="token punctuation">.</span>mock <span class="token punctuation">}</span><span class="token punctuation">)</span>

    <span class="token keyword">const</span> signUp <span class="token operator">=</span> signUpCommandBuilder<span class="token punctuation">.</span><span class="token function">getCommandFunction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span>service<span class="token punctuation">)</span>

    <span class="token keyword">const</span> payload<span class="token operator">:</span> UserV1SignUpInputPayload <span class="token operator">=</span> <span class="token keyword">undefined</span>

    <span class="token keyword">const</span> parameter<span class="token operator">:</span> UserV1SignUpInputParameter <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>

    <span class="token keyword">const</span> context <span class="token operator">=</span> <span class="token function">getCommandContextMock</span><span class="token punctuation">(</span>payload<span class="token punctuation">,</span> parameter<span class="token punctuation">,</span> sandbox<span class="token punctuation">)</span>

    <span class="token keyword">const</span> result <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">signUp</span><span class="token punctuation">(</span>context<span class="token punctuation">.</span>mock<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span>

    <span class="token function">expect</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeUndefined</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>More about unit testing in the next chapter <a href="/handbook/2._start-building/2.2_command/2_test-a-command.html" class="">Test a command</a></p><h2 id="implement-the-command" tabindex="-1"><a class="header-anchor" href="#implement-the-command" aria-hidden="true">#</a> Implement the command</h2><p>In the command builder file, you can implement the command function.<br> A command function has the service instance as <code>this</code> scope assigned. Because of this, you can&#39;t use arrow functions.</p><span class="badge danger" style="vertical-align:top;">ðŸ‘Ž does not work</span><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token punctuation">.</span><span class="token function">setCommandFunction</span><span class="token punctuation">(</span><span class="token punctuation">(</span>context<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token comment">// add your business logic here</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><span class="badge tip" style="vertical-align:top;">ðŸ‘ works</span><div class="language-typescript line-numbers-mode" data-ext="ts"><pre class="language-typescript"><code><span class="token punctuation">.</span><span class="token function">setCommandFunction</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token punctuation">(</span>context<span class="token punctuation">,</span> payload<span class="token punctuation">,</span> parameter<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// add your business logic here</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>The <code>this</code> scope allows access to methods and properties of the service instance.<br> You can access:</p><ul><li>the service config <code>this.config</code></li><li>the service information name, version and description of service with <code>this.info</code></li></ul><p><strong>It is not recommended to directly access the service instance for any other purpose.</strong>.<br> Use the function context instead, to access logger, stores and other functionality.</p><p>As types are automatically generated, depending on given schemas and settings, a logical flow for adding settings is adviced.<br> You should always start with the command function input and output schemas, follwed by the transform schemas.</p><p><img src="/graphic/command_builder.svg" alt="Command builder defintion and execution flow"></p><h3 id="command-function-context" tabindex="-1"><a class="header-anchor" href="#command-function-context" aria-hidden="true">#</a> Command function context</h3><p>The function context provides a unified interface for</p><ul><li>the logger</li><li>the original command message</li><li>the config store</li><li>the secret store</li><li>the state store</li><li>a method <code>emit</code>, which allows emitting of custom events to the event bridge</li><li>a method <code>invoke</code>, which allows invoking of other commands</li></ul><div class="hint-container tip"><p class="hint-container-title">API documentation</p><p>The <a href="/api/modules/purista_core.html#commandfunctioncontext" class="">CommandFunctionContext</a> is a union type of <a href="/api/modules/purista_core.html#contextbase" class="">ContextBase</a> and <a href="/api/modules/purista_core.html#commandfunctioncontextenhancements" class="">CommandFunctionContextEnhancements</a></p></div><h3 id="payload" tabindex="-1"><a class="header-anchor" href="#payload" aria-hidden="true">#</a> Payload</h3><p>The payload contains the payload for this command. It is validated against the input payload schema, before the command function is called. They typescript type is automatically generated from the input schema.</p><h3 id="parameter" tabindex="-1"><a class="header-anchor" href="#parameter" aria-hidden="true">#</a> Parameter</h3><p>In addition to the payload, a command function can have parameters. This is especially usefull, when the command is exposed as http or GraphQL endpoint.<br> Url parameter, query parameter or GraphQL query inputs can be mapped to parameters. The parameters will be validated against the parameter schema, before the command function is called.</p><h3 id="return-value" tabindex="-1"><a class="header-anchor" href="#return-value" aria-hidden="true">#</a> Return value</h3><p>A command function is expected to return a value. The returned value is validated against the output schema.<br> The result typescript type of the command function is generated from the output schema.</p><p>It is possible to not return a value. In this case the response message, which is always sent back, will contain a payload with value <code>undefined</code>.</p><h2 id="event-bridge-advice" tabindex="-1"><a class="header-anchor" href="#event-bridge-advice" aria-hidden="true">#</a> Event bridge advice</h2><p>The PURISTA builder for commands and subscriptions allowing the developer to give the underlaying event bridge advices.<br> Advices can help to build more robust systems and to configure the system for special needs.</p><p>If the underlaying message broker does not support a feature, required for an advice, the advice is ignored and has no effect.</p><h3 id="adviceautoacknowledgemessage" tabindex="-1"><a class="header-anchor" href="#adviceautoacknowledgemessage" aria-hidden="true">#</a> adviceAutoacknowledgeMessage</h3><p>Many message brokers have the mesage acknowledge pattern. If a message is sent from the message broker and received by the consumer, the message broker expects to get a acknowledgement from the consumer.<br> Because of this, there are two major questions here:</p><p>How to handle a message with negative or without acknowledgment?<br> This will mostly configured on the message broker itself.<br> They will re-send the message or move the message to a dead letter queue.<br> The consumer should not take care of this.</p><p>When should the consumer return the acknowledgment - on receiving the message or after processing the message?<br> This is on consumer side and the message broker can not take care of this.<br> The <code>adviceAutoacknowledgeMessage</code> method in the builders, is advising the PURISTA even bridge to send the acknowledgement as soon as the message receives. When the method is called with parameter <code>false</code>, the acknowledgement is sent, after the processing the message. In case the processing is throwing an <code>UnhandledError</code>, a negative acknowledgement is sent.</p><div class="hint-container info"><p class="hint-container-title">Default settings:</p><p>Enabled for commands by default.<br> Disabled for subscriptions by default.</p></div></div><!----><footer class="page-meta"><!----><div class="meta-item git-info"><div class="update-time"><span class="label">Last update: </span><!----></div><div class="contributors"><span class="label">Contributors: </span><!--[--><!--[--><span class="contributor" title="email: sebastianwessel@users.noreply.github.com">Sebastian Wessel</span><!--]--><!--]--></div></div></footer><nav class="page-nav"><!----><a href="/handbook/2._start-building/2.2_command/2_test-a-command.html" class="nav-link next" aria-label="Test a command"><div class="hint">Next<span class="arrow end"></span></div><div class="link">Test a command<!----></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="footer-wrapper"><div class="footer">Made from developers for developers with â¤ï¸ | <a href="/privacy.html">Privacy</a> | <a href="javascript:cc.showSettings()">Cookie preferences</a> | <a href="/imprint.html">Imprint</a></div><div class="copyright">Copyright Â© 2023 Sebastian Wessel</div></footer></div><!--]--><!--]--><!----><!--]--></div>
    <script type="module" src="/assets/app-7ccf318c.js" defer></script>
  </body>
</html>

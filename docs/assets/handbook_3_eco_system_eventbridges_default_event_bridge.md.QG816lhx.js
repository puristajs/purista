import{_ as s,c as e,o as i,V as a,ac as t}from"./chunks/framework.ITQiifkM.js";const u=JSON.parse('{"title":"Default Event Bridge","description":"Use the built in default event bridge of PURISTA","frontmatter":{"title":"Default Event Bridge","description":"Use the built in default event bridge of PURISTA","order":301010},"headers":[],"relativePath":"handbook/3_eco_system/eventbridges/default_event_bridge.md","filePath":"handbook/3_eco_system/eventbridges/default_event_bridge.md","lastUpdated":1706444636000}'),n={name:"handbook/3_eco_system/eventbridges/default_event_bridge.md"},l=a('<h1 id="default-event-bridge" tabindex="-1">Default Event Bridge <a class="header-anchor" href="#default-event-bridge" aria-label="Permalink to &quot;Default Event Bridge&quot;">​</a></h1><p>The core package comes with <code>DefaultEventBridge</code>, which will work on local without any further installation. The <code>DefaultEventBridge</code> acts as event bridge and simple message broker.</p><p>It should work out of the box for single instances. You can also use it, for simple horizontal scaling, but the messages and states are not shared or load balanced between instances.</p><p>This means a subscription is always running on the same instance. Also, any command invocation is done within the same instance. Sharing of states and data must be done over third party software, like usage of redis or other databases.</p><p>Because of this, the <code>DefaultEventBridge</code> will only work for scenarios, where you deploy your services as single instance monolith (edge) and you don&#39;t have the requirement to share messages and states across instances.</p><p>A simplified schema of how the <code>DefaultEventBridge</code> works:</p><p><img src="'+t+`" alt="single instance"></p><div class="tip custom-block"><p class="custom-block-title">Pros</p><ul><li>no extra message broker needed</li><li>full subscription support</li><li>ideal for local development and debug purpose</li></ul></div><div class="warning custom-block"><p class="custom-block-title">Cons</p><ul><li>does not scale</li><li>no persistance of messages</li><li>no retry mechanism for messages</li></ul></div><h2 id="configuration" tabindex="-1">Configuration <a class="header-anchor" href="#configuration" aria-label="Permalink to &quot;Configuration&quot;">​</a></h2><p>The <code>DefaultEventBridge</code> can be configured to emit every message, which has set the <code>eventName</code> property as javascript event. This must be enabled in the configuration by setting the <code>emitMessagesAsEventBridgeEvents</code> property to true. Than, you can subscribe to specific events in regular JavaScript fashion. The event names will be prefixed with <code>custom-</code> to avoid name collisions.</p><h2 id="usage-example" tabindex="-1">Usage example <a class="header-anchor" href="#usage-example" aria-label="Permalink to &quot;Usage example&quot;">​</a></h2><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { DefaultEventBridge } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@purista/core&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> eventBridge</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DefaultEventBridge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">({ emitMessagesAsEventBridgeEvents: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> })</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> eventBridge.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">eventBridge.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&#39;custom-example-event&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, (</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">msg</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">  console.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">log</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">JSON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">stringify</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(msg, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">null</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ... register and start your services</span></span></code></pre></div>`,13),h=[l];function r(o,p,d,k,c,g){return i(),e("div",null,h)}const m=s(n,[["render",r]]);export{u as __pageData,m as default};

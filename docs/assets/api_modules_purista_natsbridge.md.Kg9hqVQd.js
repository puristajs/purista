import{_ as e,c as t,o as a,V as s}from"./chunks/framework.ITQiifkM.js";const b=JSON.parse('{"title":"Module: @purista/natsbridge","description":"","frontmatter":{},"headers":[],"relativePath":"api/modules/purista_natsbridge.md","filePath":"api/modules/purista_natsbridge.md","lastUpdated":1708505616000}'),i={name:"api/modules/purista_natsbridge.md"},r=s(`<p><a href="./../README.html">PURISTA API</a> / <a href="./../modules.html">Modules</a> / @purista/natsbridge</p><h1 id="module-purista-natsbridge" tabindex="-1">Module: @purista/natsbridge <a class="header-anchor" href="#module-purista-natsbridge" aria-label="Permalink to &quot;Module: @purista/natsbridge&quot;">​</a></h1><p>Package for using a <a href="https://nats.io/" target="_blank" rel="noreferrer">NATS</a> broker as event bridge.<br> The event bridge supports brokers with and without JetStream enabled.</p><p>If JetStream is enabled, subscriptions which are marked as durable are persisted by using JetStream.<br> If JetStream is not available, subscription fall back to live-subscriptions without any persistence.</p><p><strong><code>Example</code></strong></p><div class="language-typescript vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">typescript</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { NatsBridge } </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &#39;@purista/natsbridge&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// create and init our eventbridge</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> eventBridge</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> new</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> NatsBridge</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">  await</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> eventBridge.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">start</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span></code></pre></div><h2 id="table-of-contents" tabindex="-1">Table of contents <a class="header-anchor" href="#table-of-contents" aria-label="Permalink to &quot;Table of contents&quot;">​</a></h2><h3 id="classes" tabindex="-1">Classes <a class="header-anchor" href="#classes" aria-label="Permalink to &quot;Classes&quot;">​</a></h3><ul><li><a href="./../classes/purista_natsbridge.NatsBridge.html">NatsBridge</a></li></ul><h3 id="type-aliases" tabindex="-1">Type Aliases <a class="header-anchor" href="#type-aliases" aria-label="Permalink to &quot;Type Aliases&quot;">​</a></h3><ul><li><a href="./purista_natsbridge.html#incomingmessagefunction">IncomingMessageFunction</a></li><li><a href="./purista_natsbridge.html#natsbridgeconfig">NatsBridgeConfig</a></li></ul><h3 id="variables" tabindex="-1">Variables <a class="header-anchor" href="#variables" aria-label="Permalink to &quot;Variables&quot;">​</a></h3><ul><li><a href="./purista_natsbridge.html#puristaversion">puristaVersion</a></li></ul><h3 id="functions" tabindex="-1">Functions <a class="header-anchor" href="#functions" aria-label="Permalink to &quot;Functions&quot;">​</a></h3><ul><li><a href="./purista_natsbridge.html#getcommandsubscriptiontopic">getCommandSubscriptionTopic</a></li><li><a href="./purista_natsbridge.html#getdefaultnatsbridgeconfig">getDefaultNatsBridgeConfig</a></li><li><a href="./purista_natsbridge.html#getqueuegroupname">getQueueGroupName</a></li><li><a href="./purista_natsbridge.html#getsubscriptiontopic">getSubscriptionTopic</a></li><li><a href="./purista_natsbridge.html#gettopicname">getTopicName</a></li></ul><h2 id="type-aliases-1" tabindex="-1">Type Aliases <a class="header-anchor" href="#type-aliases-1" aria-label="Permalink to &quot;Type Aliases&quot;">​</a></h2><h3 id="incomingmessagefunction" tabindex="-1">IncomingMessageFunction <a class="header-anchor" href="#incomingmessagefunction" aria-label="Permalink to &quot;IncomingMessageFunction&quot;">​</a></h3><p>Ƭ <strong>IncomingMessageFunction</strong>: (<code>this</code>: <a href="./../classes/purista_natsbridge.NatsBridge.html"><code>NatsBridge</code></a>, <code>error</code>: <code>NatsError</code> | <code>null</code>, <code>msg</code>: <code>Msg</code>) =&gt; <code>Promise</code>&lt;<code>void</code>&gt;</p><h4 id="type-declaration" tabindex="-1">Type declaration <a class="header-anchor" href="#type-declaration" aria-label="Permalink to &quot;Type declaration&quot;">​</a></h4><p>▸ (<code>this</code>, <code>error</code>, <code>msg</code>): <code>Promise</code>&lt;<code>void</code>&gt;</p><h5 id="parameters" tabindex="-1">Parameters <a class="header-anchor" href="#parameters" aria-label="Permalink to &quot;Parameters&quot;">​</a></h5><table><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;">Type</th></tr></thead><tbody><tr><td style="text-align:left;"><code>this</code></td><td style="text-align:left;"><a href="./../classes/purista_natsbridge.NatsBridge.html"><code>NatsBridge</code></a></td></tr><tr><td style="text-align:left;"><code>error</code></td><td style="text-align:left;"><code>NatsError</code> | <code>null</code></td></tr><tr><td style="text-align:left;"><code>msg</code></td><td style="text-align:left;"><code>Msg</code></td></tr></tbody></table><h5 id="returns" tabindex="-1">Returns <a class="header-anchor" href="#returns" aria-label="Permalink to &quot;Returns&quot;">​</a></h5><p><code>Promise</code>&lt;<code>void</code>&gt;</p><h4 id="defined-in" tabindex="-1">Defined in <a class="header-anchor" href="#defined-in" aria-label="Permalink to &quot;Defined in&quot;">​</a></h4><p><a href="https://github.com/sebastianwessel/purista/blob/master/packages/natsbridge/src/types/IncomingMessageFunction.ts#L5" target="_blank" rel="noreferrer">natsbridge/src/types/IncomingMessageFunction.ts:5</a></p><hr><h3 id="natsbridgeconfig" tabindex="-1">NatsBridgeConfig <a class="header-anchor" href="#natsbridgeconfig" aria-label="Permalink to &quot;NatsBridgeConfig&quot;">​</a></h3><p>Ƭ <strong>NatsBridgeConfig</strong>: <a href="./purista_core.html#prettify"><code>Prettify</code></a>&lt;{ <code>commandResponsePublishTwice</code>: <code>&quot;always&quot;</code> | <code>&quot;eventOnly&quot;</code> | <code>&quot;eventAndError&quot;</code> | <code>&quot;never&quot;</code> ; <code>defaultMessageExpiryInterval</code>: <code>number</code> ; <code>emptyTopicPartString</code>: <code>string</code> ; <code>maxMessages</code>: <code>number</code> ; <code>topicPrefix</code>: <code>string</code> } &amp; <code>ConnectionOptions</code>&gt;</p><p>the configuration for the NATS event bridge</p><h4 id="defined-in-1" tabindex="-1">Defined in <a class="header-anchor" href="#defined-in-1" aria-label="Permalink to &quot;Defined in&quot;">​</a></h4><p><a href="https://github.com/sebastianwessel/purista/blob/master/packages/natsbridge/src/types/NatsBridgeConfig.ts#L6" target="_blank" rel="noreferrer">natsbridge/src/types/NatsBridgeConfig.ts:6</a></p><h2 id="variables-1" tabindex="-1">Variables <a class="header-anchor" href="#variables-1" aria-label="Permalink to &quot;Variables&quot;">​</a></h2><h3 id="puristaversion" tabindex="-1">puristaVersion <a class="header-anchor" href="#puristaversion" aria-label="Permalink to &quot;puristaVersion&quot;">​</a></h3><p>• <code>Const</code> <strong>puristaVersion</strong>: <code>&quot;1.10.8&quot;</code></p><h4 id="defined-in-2" tabindex="-1">Defined in <a class="header-anchor" href="#defined-in-2" aria-label="Permalink to &quot;Defined in&quot;">​</a></h4><p><a href="https://github.com/sebastianwessel/purista/blob/master/packages/natsbridge/src/version.ts#L1" target="_blank" rel="noreferrer">natsbridge/src/version.ts:1</a></p><h2 id="functions-1" tabindex="-1">Functions <a class="header-anchor" href="#functions-1" aria-label="Permalink to &quot;Functions&quot;">​</a></h2><h3 id="getcommandsubscriptiontopic" tabindex="-1">getCommandSubscriptionTopic <a class="header-anchor" href="#getcommandsubscriptiontopic" aria-label="Permalink to &quot;getCommandSubscriptionTopic&quot;">​</a></h3><p>▸ <strong>getCommandSubscriptionTopic</strong>(<code>this</code>, <code>address</code>): <code>string</code></p><h4 id="parameters-1" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-1" aria-label="Permalink to &quot;Parameters&quot;">​</a></h4><table><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;">Type</th></tr></thead><tbody><tr><td style="text-align:left;"><code>this</code></td><td style="text-align:left;"><a href="./../classes/purista_natsbridge.NatsBridge.html"><code>NatsBridge</code></a></td></tr><tr><td style="text-align:left;"><code>address</code></td><td style="text-align:left;"><a href="./purista_core.html#ebmessageaddress"><code>EBMessageAddress</code></a></td></tr></tbody></table><h4 id="returns-1" tabindex="-1">Returns <a class="header-anchor" href="#returns-1" aria-label="Permalink to &quot;Returns&quot;">​</a></h4><p><code>string</code></p><h4 id="defined-in-3" tabindex="-1">Defined in <a class="header-anchor" href="#defined-in-3" aria-label="Permalink to &quot;Defined in&quot;">​</a></h4><p><a href="https://github.com/sebastianwessel/purista/blob/master/packages/natsbridge/src/topic/getCommandSubscriptionTopic.impl.ts#L8" target="_blank" rel="noreferrer">natsbridge/src/topic/getCommandSubscriptionTopic.impl.ts:8</a></p><hr><h3 id="getdefaultnatsbridgeconfig" tabindex="-1">getDefaultNatsBridgeConfig <a class="header-anchor" href="#getdefaultnatsbridgeconfig" aria-label="Permalink to &quot;getDefaultNatsBridgeConfig&quot;">​</a></h3><p>▸ <strong>getDefaultNatsBridgeConfig</strong>(): <code>Object</code></p><h4 id="returns-2" tabindex="-1">Returns <a class="header-anchor" href="#returns-2" aria-label="Permalink to &quot;Returns&quot;">​</a></h4><p><code>Object</code></p><table><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;">Type</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>commandResponsePublishTwice</code></td><td style="text-align:left;"><code>&quot;always&quot;</code> | <code>&quot;eventOnly&quot;</code> | <code>&quot;eventAndError&quot;</code> | <code>&quot;never&quot;</code></td><td style="text-align:left;">Indicates if a command response should be published a second time. If the command response gets published, it will be published to the regular topic pattern. If set to <code>never</code>, subscription might not get messages they are expecting because of the timing. If set to <code>always</code>, every command response is published. Because there might not be a consumer for every message, the broker will store the messages until the <code>defaultMessageExpiryInterval</code> is reached. This might result in a high ressource consumption of the broker. If set to <code>eventOnly</code>, only success responses which have a event name set, are published twice. There, we expect, that an event has at least one consumer subscription and the broker does not unnecessarily stores messages for a long time. <strong><code>Default</code></strong> <code>ts eventOnly </code></td></tr><tr><td style="text-align:left;"><code>defaultMessageExpiryInterval</code></td><td style="text-align:left;"><code>number</code></td><td style="text-align:left;">the message expiry interval in seconds <strong><code>Default</code></strong> <code>ts 30 days in seconds </code></td></tr><tr><td style="text-align:left;"><code>emptyTopicPartString</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">The string which should be used in topics for parts, which are undefined <strong><code>Default</code></strong> <code>ts __none__ </code></td></tr><tr><td style="text-align:left;"><code>maxMessages</code></td><td style="text-align:left;"><code>number</code></td><td style="text-align:left;">maximum messages to run in parallel per subscription 10 means, each subscription can handle 10 calls at the same time <strong><code>Default</code></strong> <code>ts 10 </code></td></tr><tr><td style="text-align:left;"><code>topicPrefix</code></td><td style="text-align:left;"><code>string</code></td><td style="text-align:left;">the prefix for topic to prevent name collisions <strong><code>Default</code></strong> <code>ts purista </code></td></tr></tbody></table><h4 id="defined-in-4" tabindex="-1">Defined in <a class="header-anchor" href="#defined-in-4" aria-label="Permalink to &quot;Defined in&quot;">​</a></h4><p><a href="https://github.com/sebastianwessel/purista/blob/master/packages/natsbridge/src/getDefaultNatsBridgeConfig.ts#L4" target="_blank" rel="noreferrer">natsbridge/src/getDefaultNatsBridgeConfig.ts:4</a></p><hr><h3 id="getqueuegroupname" tabindex="-1">getQueueGroupName <a class="header-anchor" href="#getqueuegroupname" aria-label="Permalink to &quot;getQueueGroupName&quot;">​</a></h3><p>▸ <strong>getQueueGroupName</strong>(<code>prefix</code>, <code>address</code>): <code>string</code></p><h4 id="parameters-2" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-2" aria-label="Permalink to &quot;Parameters&quot;">​</a></h4><table><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;">Type</th></tr></thead><tbody><tr><td style="text-align:left;"><code>prefix</code></td><td style="text-align:left;"><code>string</code></td></tr><tr><td style="text-align:left;"><code>address</code></td><td style="text-align:left;"><a href="./purista_core.html#ebmessageaddress"><code>EBMessageAddress</code></a></td></tr></tbody></table><h4 id="returns-3" tabindex="-1">Returns <a class="header-anchor" href="#returns-3" aria-label="Permalink to &quot;Returns&quot;">​</a></h4><p><code>string</code></p><h4 id="defined-in-5" tabindex="-1">Defined in <a class="header-anchor" href="#defined-in-5" aria-label="Permalink to &quot;Defined in&quot;">​</a></h4><p><a href="https://github.com/sebastianwessel/purista/blob/master/packages/natsbridge/src/getQueueGroupName.impl.ts#L3" target="_blank" rel="noreferrer">natsbridge/src/getQueueGroupName.impl.ts:3</a></p><hr><h3 id="getsubscriptiontopic" tabindex="-1">getSubscriptionTopic <a class="header-anchor" href="#getsubscriptiontopic" aria-label="Permalink to &quot;getSubscriptionTopic&quot;">​</a></h3><p>▸ <strong>getSubscriptionTopic</strong>(<code>this</code>, <code>subscription</code>): <code>string</code></p><h4 id="parameters-3" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-3" aria-label="Permalink to &quot;Parameters&quot;">​</a></h4><table><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;">Type</th></tr></thead><tbody><tr><td style="text-align:left;"><code>this</code></td><td style="text-align:left;"><a href="./../classes/purista_natsbridge.NatsBridge.html"><code>NatsBridge</code></a></td></tr><tr><td style="text-align:left;"><code>subscription</code></td><td style="text-align:left;"><a href="./purista_core.html#subscription"><code>Subscription</code></a></td></tr></tbody></table><h4 id="returns-4" tabindex="-1">Returns <a class="header-anchor" href="#returns-4" aria-label="Permalink to &quot;Returns&quot;">​</a></h4><p><code>string</code></p><h4 id="defined-in-6" tabindex="-1">Defined in <a class="header-anchor" href="#defined-in-6" aria-label="Permalink to &quot;Defined in&quot;">​</a></h4><p><a href="https://github.com/sebastianwessel/purista/blob/master/packages/natsbridge/src/topic/getSubscriptionTopic.impl.ts#L8" target="_blank" rel="noreferrer">natsbridge/src/topic/getSubscriptionTopic.impl.ts:8</a></p><hr><h3 id="gettopicname" tabindex="-1">getTopicName <a class="header-anchor" href="#gettopicname" aria-label="Permalink to &quot;getTopicName&quot;">​</a></h3><p>▸ <strong>getTopicName</strong>(<code>this</code>, <code>message</code>): <code>string</code></p><p>Calculates the NATS topic name for a message which should be sent. Something like: purista/message_type/instance_id/sender_name/sender_version/sender_target/eventname/receiver_name/receiver_version/receiver_target</p><h4 id="parameters-4" tabindex="-1">Parameters <a class="header-anchor" href="#parameters-4" aria-label="Permalink to &quot;Parameters&quot;">​</a></h4><table><thead><tr><th style="text-align:left;">Name</th><th style="text-align:left;">Type</th><th style="text-align:left;">Description</th></tr></thead><tbody><tr><td style="text-align:left;"><code>this</code></td><td style="text-align:left;"><a href="./../classes/purista_natsbridge.NatsBridge.html"><code>NatsBridge</code></a></td><td style="text-align:left;">-</td></tr><tr><td style="text-align:left;"><code>message</code></td><td style="text-align:left;"><a href="./purista_core.html#ebmessage"><code>EBMessage</code></a></td><td style="text-align:left;">the message to send</td></tr></tbody></table><h4 id="returns-5" tabindex="-1">Returns <a class="header-anchor" href="#returns-5" aria-label="Permalink to &quot;Returns&quot;">​</a></h4><p><code>string</code></p><p>the NATS topic</p><h4 id="defined-in-7" tabindex="-1">Defined in <a class="header-anchor" href="#defined-in-7" aria-label="Permalink to &quot;Defined in&quot;">​</a></h4><p><a href="https://github.com/sebastianwessel/purista/blob/master/packages/natsbridge/src/topic/getTopicName.impl.ts#L18" target="_blank" rel="noreferrer">natsbridge/src/topic/getTopicName.impl.ts:18</a></p>`,83),o=[r];function n(d,l,c,h,g,p){return a(),t("div",null,o)}const f=e(i,[["render",n]]);export{b as __pageData,f as default};

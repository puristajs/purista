import{_ as t,C as n,c as l,o as h,G as r,w as k,a as s,j as i}from"./chunks/framework.U_AETC1W.js";const m=JSON.parse('{"title":"Version 1.6","description":"Checkout all the awesome features, improvements and changes in PURISTA v1.6.0 typescript framework.","frontmatter":{"title":"Version 1.6","description":"Checkout all the awesome features, improvements and changes in PURISTA v1.6.0 typescript framework.","date":"2023-05-20T00:00:00.000Z","order":20230520,"image":"/graphic/purista_1_6_cover.png"},"headers":[],"relativePath":"article/2023-20-05-purista-version-1-6-0.md","filePath":"article/2023-20-05-purista-version-1-6-0.md","lastUpdated":1706444636000}'),o={name:"article/2023-20-05-purista-version-1-6-0.md"};function p(d,e,c,g,E,u){const a=n("PostDetail");return h(),l("div",null,[r(a,null,{default:k(()=>e[0]||(e[0]=[s(" PURISTA version 1.6.0 comes with a set of new event bridges. Starting from version 1.6.0, the new MQTT event bridge supports the MQTT protocol. This is a huge step forward if you're developing solutions for IoT and Edge. "),i("hr",null,null,-1),i("p",null,"On the other side, Dapr support is now added for cloud environments. This not only includes simple deployments and usage of the core event functionality. The new Dapr-SDK provides also the integration of state, config, and secret stores via Dapr.",-1),i("p",null,[i("strong",null,"PURISTA now requires Node version >= 18.15"),s(". Also, the provided PURISTA packages no longer contain source map files, resulting in a much smaller size.")],-1),i("p",null,[s("A very common task is, to build an HTTP adapter and call external REST APIs. For such a task, the new base class "),i("code",null,"HttpClient"),s(" is available, which is based on the native fetch function. Error handling, JSON decoding, timeout handling, and OpenTelemetry support are built in.")],-1),i("p",null,"In addition, there are a bunch of improvements regarding types, and configurations, and some bugs have been fixed.",-1),i("h2",{id:"mqtt-event-bridge",tabindex:"-1"},[s("MQTT event bridge "),i("a",{class:"header-anchor",href:"#mqtt-event-bridge","aria-label":'Permalink to "MQTT event bridge"'},"​")],-1),i("p",null,"By providing the MQTT event bridge, PURISTA is making a huge step into the IoT and edge device area. The MQTT bridge is based on the MQTT 5 protocol, which makes it possible to provide nearly the same functionality as on other event bridges.",-1),i("h2",{id:"dapr-sdk",tabindex:"-1"},[s("Dapr SDK "),i("a",{class:"header-anchor",href:"#dapr-sdk","aria-label":'Permalink to "Dapr SDK"'},"​")],-1),i("p",null,"The SDK for Dapr includes an event bridge and adapters for config, secret and state stores. This allows an easy integration into the Dapr infrastructure without touching the business logic.",-1),i("h2",{id:"http-client",tabindex:"-1"},[s("Http client "),i("a",{class:"header-anchor",href:"#http-client","aria-label":'Permalink to "Http client"'},"​")],-1),i("p",null,[s("The core package has some new nice helpers. With the "),i("code",null,"HttpClient"),s(" class, it is possible to build HTTP-based clients quickly & easily.")],-1),i("p",null,[s("The "),i("code",null,"HttpClient"),s(" is based on Node.js native "),i("code",null,"fetch"),s(".")],-1),i("p",null,"Example:",-1),i("div",{class:"language-typescript vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"typescript"),i("pre",{class:"shiki shiki-themes github-light github-dark vp-code",tabindex:"0"},[i("code",null,[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," { HttpClient } "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"from"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}}," '@purista/core'")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"type"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," LoginResponse"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#E36209","--shiki-dark":"#FFAB70"}},"  token"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},":"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," string")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"const"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," main"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," async"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," () "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"=>"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," client"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," new"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}}," HttpClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"({")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    baseUrl: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'http://example.com'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    defaultHeaders: {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"      'content-type'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},": "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'application/json; charset=utf-8'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    },")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  })")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," loginCredentials"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    username: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'user'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"    password: "),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'secret_thing'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},",")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  }")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  // to a POST request to receive a bearer token")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," loginResponse"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," await"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"post"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"<"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"LoginResponse"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},">("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'/login'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},", loginCredentials)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  // set the bearer token for all following requests")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"setBearerToken"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(loginResponse.token)")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  // make a GET request with bearer token set in header")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}},"  const"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#79B8FF"}}," restrictedResponse"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," ="),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F97583"}}," await"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}}," client."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"get"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#9ECBFF"}},"'/restricted/path'"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#6A737D"}},"  // log the response from a protected route")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"  console."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"log"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"(restrictedResponse)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"}")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#B392F0"}},"main"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#E1E4E8"}},"()")])])])],-1),i("h2",{id:"improvements",tabindex:"-1"},[s("Improvements "),i("a",{class:"header-anchor",href:"#improvements","aria-label":'Permalink to "Improvements"'},"​")],-1),i("p",null,"This release contains a lot of improvements. By default, HTTP compression is enabled in the Dapr event bridge and the Kubernetes webserver. Configurations are now more flat to avoid too much nested parameters.",-1),i("p",null,[s("Dependencies have been updated to the most recent versions. Because of this, the plugin "),i("code",null,"@anatine/zod-openapi"),s(" is replaced by a own version. A lot of unit and integration tests have been added to the project.")],-1),i("h2",{id:"shout-out",tabindex:"-1"},[s("Shout out "),i("a",{class:"header-anchor",href:"#shout-out","aria-label":'Permalink to "Shout out"'},"​")],-1),i("p",null,'A special "Thank You!" to the contributors and developers of:',-1),i("ul",null,[i("li",null,[i("a",{href:"https://hono.dev",target:"_blank",rel:"noreferrer"},"Hono")]),i("li",null,[i("a",{href:"https://www.emqx.io",target:"_blank",rel:"noreferrer"},"EMQ")]),i("li",null,[i("a",{href:"https://github.com/tgreyuk/typedoc-plugin-markdown",target:"_blank",rel:"noreferrer"},"typedoc-plugin-markdown")]),i("li",null,[i("a",{href:"https://snappify.com/",target:"_blank",rel:"noreferrer"},"Snappify")])],-1),i("p",null,"Thanks for your cool stuff and your help - I appreciate it!",-1)])),_:1})])}const F=t(o,[["render",p]]);export{m as __pageData,F as default};

import { getCommandContextMock, getEventBridgeMock, getLoggerMock } from '@purista/core'
import { createSandbox } from 'sinon'

import { {{camelCase service.name}}V{{service.version}}Service } from '../../{{camelCase service.name}}V{{service.version}}Service'
import { {{camelCase name}}CommandBuilder } from './{{camelCase name}}CommandBuilder'
import { {{properCase service.name}}V{{service.version}}{{properCase name}}InputPayload, {{properCase service.name}}V{{service.version}}{{properCase name}}InputParameter } from './types'

describe('service {{properCase service.name}} version {{service.version}} - command {{camelCase name}}', () => {
  let sandbox = createSandbox()
  beforeEach(() => {
    sandbox = createSandbox()
  })

  afterEach(() => {
    sandbox.restore()
  })

  test('does not throw', async () => {
    const service = {{camelCase service.name}}V{{service.version}}Service.getInstance(getEventBridgeMock(sandbox).mock, { logger: getLoggerMock(sandbox).mock })

    const {{camelCase name}} = {{camelCase name}}CommandBuilder.getCommandFunction().bind(service)

    const payload: {{properCase service.name}}V{{service.version}}{{properCase name}}InputPayload = undefined

    const parameter: {{properCase service.name}}V{{service.version}}{{properCase name}}InputParameter = {}

    const context = getCommandContextMock(payload, parameter, sandbox)

    const result = await {{camelCase name}}(context.mock, payload, parameter)

    expect(result).toBeUndefined()
  })
})
